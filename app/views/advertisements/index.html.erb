<div class="load">
	<%= image_tag "loading.gif" %>
</div>

<div class="row">
	<div class="col-md-3">
		<h4>Categories</h4>
		<div class="panel-group" id="accordion">
			<% @categories.each do|category| %>
			  <div class="panel panel-default">
			    <div class="panel-heading">
			      <h4 class="panel-title">
			        <%= link_to category.name, advertisements_path(category_id: category.id), remote: true, :class=> "category_search" %>
			        <a data-toggle="collapse" data-parent="#accordion" href="#category_<%= category.id %>" style="float:right">
			        	<%= image_tag "down_arrow.png", :class=>"down_arrow" %>
			        </a>
			      </h4>
			    </div>
			    <div id="category_<%= category.id %>" class="panel-collapse collapse">
			      <div class="panel-body">
			        <ul class="list-group">
						<% category.sub_categories.each do |sub_category| %>
						  <li class="list-group-item">
						    <%= link_to sub_category.name, advertisements_path(sub_category_id: sub_category.id), remote: true, :class=> "category_search"%>
						  </li>
						<% end %>
					</ul>
			      </div>
			    </div>
			  </div>
			<% end %>
		</div>

		<div class="filter_box">
			<%= form_tag advertisements_path, :method=> "get", :class=>"filter_form", remote: true do %>
				<h4>Filter by : </h4>
				<h4>Store</h4><%= text_field_tag "store_id" %><br/>
				<h4>Zone</h4><%= text_field_tag "zone_id" %><br/>
				<h4>Start Date</h4><%= text_field_tag "start_date", "", :class=>"datepicker", :style=>"width:100%" %><br/>
				<h4>End Date</h4><%= text_field_tag "end_date", "", :class=>"datepicker", :style=>"width:100%" %><br/>
				<%= submit_tag "search" %>
			<% end %>
		</div>
	</div>
	<div class="col-md-9 advertisement_block">
		<!-- <div style="height: 50px;">
			<%#= link_to "box", advertisements_path(layout: "box"),:class=> "btn btn-default pull-right" %>
			<%#= link_to "list", advertisements_path(layout: "list"),:class=> "btn btn-default pull-right" %>
		</div> -->
		<%= render 'index_box' %>
	</div>
</div>

<script>
	$(".filter_form").submit(function(){
		if ($("#store_id").val() != "" || $("#zone_id").val() != "" || $(".datepicker").val() != "" ){
			$(".load").show()
		}
	})

	$(".category_search").click(function(){
		$(".load").show()
	})

	$(function() {
    $("#store_id").tokenInput("/get_store.json", {
    	tokenLimit: 1
    });
  });

  $(".get_zone").submit(function(){
		if ($("#zone_id").val() != ""){
			$(".load").show()
		}
	})

	$(function() {
    $("#zone_id").tokenInput("/get_zone.json", {
    	tokenLimit: 1
    });
  });

</script>
